<div class="max-w-2xl mb-10 w-full mx-auto bg-white p-6 rounded-2xl shadow-md">
    <h1 class="text-2xl font-semibold mb-6">Website Settings</h1>

    <ul class="divide-y divide-gray-200" id="settings-list">

      <!-- Contoh Setting -->
      <li class="py-4" data-key="website_name">
        <div class="flex justify-between items-start">
          <div class="w-full">
            <p class="text-sm text-gray-500 mb-1">Website Name</p>
            <p class="text-base font-medium text-gray-800 view-mode"><%= data.website_name %></p>
            <div class="relative z-0 w-full group hidden edit-mode">
              <input type="text" class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-blue-300 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" " value="<%= data.website_name %>" />
            </div>
          </div>
          <button class="text-gray-500 hover:text-blue-600 ml-4 edit-toggle">
            <i class="text-xl bi bi-pencil-square"></i>
          </button>
        </div>
        <div class="flex gap-2 mt-3 hidden edit-mode">
          <button class="save-btn text-sm bg-blue-600 text-white px-4 py-1.5 rounded-lg hover:bg-blue-700">Simpan</button>
          <button class="cancel-btn text-sm bg-gray-300 text-gray-800 px-4 py-1.5 rounded-lg hover:bg-gray-400">Batal</button>
        </div>
      </li>

      <!-- Tambahkan setting lainnya seperti ini -->
      <li class="py-4" data-key="Website URL">
        <div class="flex justify-between items-start">
          <div class="w-full">
            <p class="text-sm text-gray-500 mb-1">Website URL</p>
            <p class="text-base font-medium text-gray-800 view-mode"><%= data.website_url %></p>
            <div class="relative z-0 w-full group hidden edit-mode">
              <input type="text" class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-blue-300 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" " value="<%= data.website_url %>" />
            </div>
          </div>
          <button class="text-gray-500 hover:text-blue-600 ml-4 edit-toggle">
            <i class="text-xl bi bi-pencil-square"></i>
          </button>
        </div>
        <div class="flex gap-2 mt-3 hidden edit-mode">
          <button class="save-btn text-sm bg-blue-600 text-white px-4 py-1.5 rounded-lg hover:bg-blue-700">Simpan</button>
          <button class="cancel-btn text-sm bg-gray-300 text-gray-800 px-4 py-1.5 rounded-lg hover:bg-gray-400">Batal</button>
        </div>
      </li>
      <li class="py-4" data-key="email">
        <div class="flex justify-between items-start">
          <div class="w-full">
            <p class="text-sm text-gray-500 mb-1">Email</p>
            <p class="text-base font-medium text-gray-800 view-mode"><%= data.email %></p>
            <div class="relative z-0 w-full group hidden edit-mode">
              <input type="email" class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-blue-300 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" " value="<%= data.email %>" />
            </div>
          </div>
          <button class="text-gray-500 hover:text-blue-600 ml-4 edit-toggle">
            <i class="text-xl bi bi-pencil-square"></i>
          </button>
        </div>
        <div class="flex gap-2 mt-3 hidden edit-mode">
          <button class="save-btn text-sm bg-blue-600 text-white px-4 py-1.5 rounded-lg hover:bg-blue-700">Simpan</button>
          <button class="cancel-btn text-sm bg-gray-300 text-gray-800 px-4 py-1.5 rounded-lg hover:bg-gray-400">Batal</button>
        </div>
      </li>
      <li class="py-4" data-key="telp">
        <div class="flex justify-between items-start">
          <div class="w-full">
            <p class="text-sm text-gray-500 mb-1">Telp/Whatsapp</p>
            <p class="text-base font-medium text-gray-800 view-mode"><%= data.telp %></p>
            <div class="relative z-0 w-full group hidden edit-mode">
              <input type="number" class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-blue-300 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" " value="<%= data.telp %>" />
            </div>
          </div>
          <button class="text-gray-500 hover:text-blue-600 ml-4 edit-toggle">
            <i class="text-xl bi bi-pencil-square"></i>
          </button>
        </div>
        <div class="flex gap-2 mt-3 hidden edit-mode">
          <button class="save-btn text-sm bg-blue-600 text-white px-4 py-1.5 rounded-lg hover:bg-blue-700">Simpan</button>
          <button class="cancel-btn text-sm bg-gray-300 text-gray-800 px-4 py-1.5 rounded-lg hover:bg-gray-400">Batal</button>
        </div>
      </li>
      <li class="py-4" data-key="instagram">
        <div class="flex justify-between items-start">
          <div class="w-full">
            <p class="text-sm text-gray-500 mb-1">Instagram</p>
            <p class="text-base font-medium text-gray-800 view-mode"><%= data.instagram %></p>
            <div class="relative z-0 w-full group hidden edit-mode">
              <input type="instagram" class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-blue-300 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" " value="<%= data.instagram %>" />
            </div>
          </div>
          <button class="text-gray-500 hover:text-blue-600 ml-4 edit-toggle">
            <i class="text-xl bi bi-pencil-square"></i>
          </button>
        </div>
        <div class="flex gap-2 mt-3 hidden edit-mode">
          <button class="save-btn text-sm bg-blue-600 text-white px-4 py-1.5 rounded-lg hover:bg-blue-700">Simpan</button>
          <button class="cancel-btn text-sm bg-gray-300 text-gray-800 px-4 py-1.5 rounded-lg hover:bg-gray-400">Batal</button>
        </div>
      </li>
      <li class="py-4" data-key="facebook">
        <div class="flex justify-between items-start">
          <div class="w-full">
            <p class="text-sm text-gray-500 mb-1">Facebook</p>
            <p class="text-base font-medium text-gray-800 view-mode"><%= data.facebook %></p>
            <div class="relative z-0 w-full group hidden edit-mode">
              <input type="text" class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-blue-300 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder=" " value=<%= data.facebook %>" />
            </div>
          </div>
          <button class="text-gray-500 hover:text-blue-600 ml-4 edit-toggle">
            <i class="text-xl bi bi-pencil-square"></i>
          </button>
        </div>
        <div class="flex gap-2 mt-3 hidden edit-mode">
          <button class="save-btn text-sm bg-blue-600 text-white px-4 py-1.5 rounded-lg hover:bg-blue-700">Simpan</button>
          <button class="cancel-btn text-sm bg-gray-300 text-gray-800 px-4 py-1.5 rounded-lg hover:bg-gray-400">Batal</button>
        </div>
      </li>
      <li class="py-4" data-key="mata_uang">
        <div class="flex justify-between items-start">
            <div class="w-full">
            <p class="text-sm text-gray-500 mb-1">Currency</p>
            <% currency.forEach(element => {%>
                <% if (element.value === data.mata_uang) {%>
                    <p class="text-base font-medium text-gray-800 view-mode"><%= element.label  %></p>
                <%} %>
            <% }); %>
            <div class="relative z-0 w-full group hidden edit-mode">
                <select class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-blue-300 focus:outline-none focus:ring-0 focus:border-blue-600 peer">
                    <% currency.forEach(item => {%>
                        <% if (item.value === data.mata_uang) {%>
                            <option value="<%= data.mata_uang %>" selected><%= item.label %></option>

                        <% } else {%>
                            <option value="<%= item.value %>"><%= item.label %></option>
                        <%} %>
                    <% }); %>
                </select>
            </div>
            </div>
            <button class="text-gray-500 hover:text-blue-600 ml-4 edit-toggle">
            <i class="text-xl bi bi-pencil-square"></i>
            </button>
        </div>
        <div class="flex gap-2 mt-3 hidden edit-mode">
            <button class="save-btn text-sm bg-blue-600 text-white px-4 py-1.5 rounded-lg hover:bg-blue-700">Simpan</button>
            <button class="cancel-btn text-sm bg-gray-300 text-gray-800 px-4 py-1.5 rounded-lg hover:bg-gray-400">Batal</button>
        </div>
        </li>


      <!-- Kamu bisa duplikat elemen <li> di atas untuk URL, telp, instagram, dll -->

    </ul>
  </div>

<script>
  document.querySelectorAll('.edit-toggle').forEach(button => {
    button.addEventListener('click', () => {
      const li = button.closest('li');
      li.querySelector('.view-mode').classList.add('hidden');
      li.querySelectorAll('.edit-mode').forEach(el => el.classList.remove('hidden'));
    });
  });

  document.querySelectorAll('.cancel-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const li = btn.closest('li');
      const input = li.querySelector('input, select');
      const view = li.querySelector('.view-mode');
      input.value = view.textContent.trim();
      li.querySelectorAll('.edit-mode').forEach(el => el.classList.add('hidden'));
      view.classList.remove('hidden');
    });
  });

  document.querySelectorAll('.save-btn').forEach(btn => {
    btn.addEventListener('click', async () => {
      const li = btn.closest('li');
      const input = li.querySelector('input, select');
      const view = li.querySelector('.view-mode');
      const key = li.dataset.key;
      const newValue = input.value.trim();

      try {
        const response = await fetch('/dashboard/settings/update', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ key: key, value: newValue })
        });

        const result = await response.json();
        

        if (result.result.success) {
          // Update tampilan view-mode dengan nilai baru
          view.textContent = input.tagName === 'SELECT'
            ? input.options[input.selectedIndex].textContent
            : newValue;

          li.querySelectorAll('.edit-mode').forEach(el => el.classList.add('hidden'));
          view.classList.remove('hidden');
        } else {
          alert('Gagal menyimpan: ' + result.message);
        }

      } catch (error) {
        console.error('Gagal menyimpan setting:', error);
        alert('Terjadi kesalahan saat menyimpan.');
      }
    });
  });
</script>

